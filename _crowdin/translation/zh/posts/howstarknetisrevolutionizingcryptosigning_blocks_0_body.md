# StarkNet如何革新加密签名技术
## *抛弃复杂的钥匙，使用面部识别技术。 账户抽象化案例研究*
一旦人们可以使用熟悉的方法，如面部识别来签署加密交易，我们将看到自我托管的繁荣。 每个人都知道拥有自己的钱包是最初的加密货币理想，但这让人感到害怕，因此人们选择使用交易所。 这是一个案例研究，介绍了StarkNet功能之一的账户抽象如何被Braavos使用，以获得更直观的钱包使用方式。
## 介绍账户抽象化
在FTX丑闻之后，这个问题比以往任何时候都更加相关。 为什么人们仍然选择将他们的加密货币交给中央机构，而不是自己保管？ 答案：对于大多数人来说，自我托管是复杂的。 种子短语是最差但又是最好的恢复机制，阻止了许多人（甚至一些最顽固的变体）。 这个挑战的答案是：抽象化的账户。 账户抽象允许钱包满足（并超越）Web2用户的UX期望，例如使用Face ID签署交易或使用双因素身份验证。 它可以促进账户分割和支出限制；最终使简单的账户恢复和完全删除种子短语成为可能。 这是一场UI和UX的革命。
## 星网
StarkNet是领先的有效性Rollup，具有几个关键特征，使其成为扩展以太坊最有前途的解决方案。 基于STARK证明，它提供了低的燃气费用，而不会影响以太坊的安全性。 STARK证明在StarkEx上的记录包括8000亿美元的累计交易量，3亿次交易和9000万个NFT。 STARK证明提供低费用的能力，再加上账户抽象的强大功能，使得Braavos能够开发出其所追求的创新钱包功能。
## A. 背景
大多数主要的区块链，包括比特币和以太坊，使用secp256k1椭圆曲线加密签名方案（请参见[此处](http://ethanfast.com/top-crypto.html)获取全面列表）。 这个椭圆曲线实现被认为是健壮的 - 许多区块链使用它并经受住了时间的考验。 但它与移动设备硬件安全模块（HSM）中可用的加密签名方案不兼容，例如iPhone和Android（Pixel和其他）手机。 这些设备使用另一条曲线——secp256r1（也称为NIST-P256）。 这意味着使用这些区块链的用户无法利用其设备上的安全芯片，如果他们想获得强大的安全级别，则必须默认使用硬件钱包。 这严重限制了用户在钱包登录和批准交易方面的任何UX创新（因此，种子短语变得普遍） StarkNet不支持secp256r1，而是采用了一种专有的曲线，这是一种STARK友好型曲线。 但与其他区块链不同的是，StarkNet 在其平台上本地提供了账户抽象功能，为钱包应用程序开启了新的用户体验机遇。 Braavos利用这种能力推出了硬件签名器。
## 硬件签名者
硬件签名器由两个主要部分组成：
* The secure sub-system in users’ mobile device * The account smart contract that can run arbitrary logic (a.k.a Account Abstraction)
## 安全子系统
硬件签名器利用用户设备中内置的安全子系统——iPhone 的**安全区域**或 Android 手机的**Titan** HSM 来保护账户。 ![](https://miro.medium.com/max/1400/0*EPm8q10ykvFGnvcv) The Secure Enclave / Titan chip is a dedicated and isolated sub-system, totally separated from the application processor that can generate private keys and sign messages. It generates the keys using an internal True Random Number Generator (TRNG) and signs messages over the NIST-P256 (secp256r1) elliptic curve via its internal Public Key Accelerator (PKA). The private keys never leave the secure system and are unknown/inaccessible to anyone, not even to the user, or to the application itself. This means that even if the device application processor kernel becomes compromised, user keys stay safe! ![](https://miro.medium.com/max/1400/0*yHJ--fK8keNdTci8)
## Deeper Dive into the Secure Enclave
During the chip manufacturing process a UID (Unique Identifier) is generated by the TRNG and is stored in the PKA. It can’t be read and never leaves the PKA, thus it is unknown even to the Secure Enclave processor and to the Secure Enclave Processor Operating System (SepOS). This UID is a random number which is unique per device and is used to encrypt all other keys that will be generated in the future on this device.\ The way it works is as follows: the application will request the SepOS to generate a new key-pair, the SepOS will instruct the Secure Enclave TRNG to generate a key and encrypt it (using the UID). The app can then request from the SepOS to decrypt the key and sign a message using the generated key. During this entire process the generated key does not leave the enclave and is unknown to anyone. (For more information on the Secure Enclave, please see [here](https://support.apple.com/en-il/guide/security/sec59b0b31ff/web)). The way the Secure Enclave is built and operates, along with the fact that it is a target for attacks by powerful corporations and governments around the world, is the reason its security surpasses standard hardware wallets.
## 抽象化账户
The power of Braavos as a smart contract based wallet on top of StarkNet, is that it is comprised of two pillars:
* The client side (e.g. the application) that allows the user to review/sign transactions and send them to the chain. * The on-chain side — has an account smart contract that can run arbitrary logic; and in particular in our case, run arbitrary signature **verification** logic. The application signs the transaction using the mobile device security module and then sends it to the account contract on-chain that can verify it. As mentioned above, the security module on iPhones and Android phones uses a cryptography that is called NIST-P256 (secp256r1), which is not compatible with any major blockchain cryptographic scheme, including StarkNet. This is why having a smart contract account on-chain that all transactions go through and can run arbitrary logic, is crucial in utilizing these HSMs on iPhones and Android phones. ![](https://miro.medium.com/max/1400/0*1gItqYMJgmpu_fXc)
## Biometrics
How does the user approve a transaction via Braavos wallet? Can a malicious application simply auto-sign a transaction without the user’s consent? No!! The cool thing about the built-in security module in mobile devices, such as the Secure Enclave, is that it supports intrinsically biometric authentication of the user identity. This means that even the actual approval to sign a transaction is done directly versus the Secure Enclave. The approval does not go through the application, and the user will need to approve the transaction with his fingerprint or face identification.
## Recovery
If no one knows the private key, what happens if the device gets lost or becomes bricked? How can the user gain back control of the account? In Braavos, an account will actually have 2 public keys — the Hardware Signer key, which will be used to sign all transactions, and the key derived from the seed phrase that can only sign one transaction — a “Request to remove Hardware Signer”. This request won’t be executed immediately, but rather will have a time delay of 4 days (configurable) in order to allow the user to use the Hardware Signer to cancel such a request. This means that if the device gets stolen/lost/bricked, users will still be able to recover their account within 4 days. However, if their Seed Phrase gets stolen and an attacker issues a request to remove the Hardware Signer, the user will automatically (and repeatedly) get a notification to their mobile device and will be able to cancel the request and keep all of the assets safe.
## Summary
The Hardware Signer feature offers both state-of-the-art security level for crypto users, and the experience users are used to from web2. In this sense, signing a transaction is as smooth and worry free as paying with Apple/Google pay. This is just one, yet prominent, example of the power of StarkNet, smart contract based wallet (a.k.a Account Abstraction) and the new design space it enables. We foresee the development of more and more nascent capabilities that will drive the crypto industry to a better and more inclusive future, providing new and existing users alike with uncompromised security coupled with uncompromised UX.